---
- name: Remove /root/AmazonCloudWatchAgent.zip
  file: path=/root/AmazonCloudWatchAgent.zip state=absent

- name: Remove installation directory
  file: path=/tmp/AmazonCloudWatchAgent state=absent

- name: Stop amazon-cloudwatch-agent
  service: name=amazon-cloudwatch-agent state=stopped enabled=false
  ignore_errors: yes

- name: Uninstall amazon-cloudwatch-agent
  apt: name=amazon-cloudwatch-agent state=absent

- name: Uninstall /etc/logrotate.d/amazon-cloudwatch-agent
  file: path=/etc/logrotate.d/amazon-cloudwatch-agent state=absent

- name: Uninstall CloudWatchAgent config
  file: path=/opt/aws/amazon-cloudwatch-agent state=absent
