// --- Integration test stuff -------------------------------------------------------------------------------

testSets {
  integrationTest
}

compileIntegrationTestKotlin {
  kotlinOptions {
    javaParameters = true
    jvmTarget = '11'
    freeCompilerArgs = ['-Xjsr305=strict']
  }
}

dependencies {
  integrationTestImplementation 'org.springframework.amqp:spring-rabbit'
  integrationTestImplementation "org.testcontainers:mariadb:$testcontainersVersion"
  integrationTestImplementation "org.testcontainers:rabbitmq:$testcontainersVersion"
  integrationTestImplementation "org.apache.commons:commons-lang3:$commonsLang3Version"
}

integrationTest {
  doFirst {
    mkdir "$buildDir/log"
  }
}

integrationTest.mustRunAfter test
check.dependsOn integrationTest
