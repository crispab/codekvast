apply from: "$rootDir/gradle/spring-boot-app.gradle"
apply from: "$rootDir/gradle/spring-boot-jdbc.gradle"
apply from: "$rootDir/gradle/spring-boot-web.gradle"
apply from: "$rootDir/gradle/kotlin-jdk8.gradle"

description = 'The Codekvast Backoffice'
applicationName = 'codekvast-backoffice'
archivesBaseName = 'codekvast-backoffice'
version = codekvastVersion
mainClassName = 'io.codekvast.backoffice.CodekvastBackofficeApplication'

apply from: "$projectDir/src/integrationTest/build.gradle"

dependencies {
    implementation project(":product:server:common")
    implementation 'org.drools:drools-compiler:7.33.0.Final'
    implementation "com.google.code.gson:gson:$gsonVersion"
    implementation 'org.springframework.boot:spring-boot-starter-mustache'
    implementation 'org.springframework.boot:spring-boot-starter-mail'

    runtimeOnly project(':product:server:db-migration')
}

run {
    dependsOn startDockerContainers

    jvmArgs = [
        '-enableassertions',
    ]

    args = [
        "--logging.file.name=$buildDir/log/${applicationName}.log"
    ]
}

bootRun {
    dependsOn startDockerContainers

    jvmArgs = run.jvmArgs
    args = run.args
}

//--- Packaging ------------------------------------------------------------------------------------------------------------------
bootJar {
    launchScript {
        properties([
            'initInfoProvides'        : applicationName,
            'initInfoShortDescription': 'Codekvast Backoffice',
            'initInfoDescription'     : 'Codekvast Backoffice offers a management interface for Codekvast',
        ])
    }
}
