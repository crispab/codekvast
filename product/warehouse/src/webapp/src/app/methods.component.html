<div id="container" class="container-fluid">
    <form (ngSubmit)="search()" #searchForm="ngForm">
        <div class="form-group row">
            <label for="signature" class="col-2 col-form-label">Signature</label>
            <div class="col-6">
                <input class="form-control"
                       id="signature"
                       name="signature"
                       [(ngModel)]="signature"
                       type="text"
                       placeholder="Search method signature">
            </div>
        </div>
        <div class="form-group row">
            <label for="maxResults" class="col-2 col-form-label">Max&nbsp;Results</label>
            <div class="col-2">
                <input class="form-control" id="maxResults" name="maxResults" [(ngModel)]="maxResults" type="number" min="1" max="10000">
            </div>
            <button type="submit" class="btn btn-primary btn-sm" [disabled]="!searchForm.form.valid">Search
            </button>
            <div *ngIf="data">
                <small class="ml-2 col-form-label form-text text-muted">Found {{data.numMethods}} methods in {{data.queryTimeMillis}} ms
                </small>
            </div>
        </div>
    </form>

    <div *ngIf="errorMessage">{{errorMessage}}</div>

    <div *ngIf="sortedMethods()" class="row ml-1">
        <div class="col-8">
            <table id="search-results" class="table table-responsive table-striped table-hover table-sm">
                <thead>
                <tr>
                    <th (click)="sortBySignature()">Signature <i [ngClass]="headerIconClassesSignature()" aria-hidden="true"></i></th>
                    <th class="w-25" (click)="sortByAge()">Age <i [ngClass]="headerIconClassesAge()" aria-hidden="true"></i></th>
                    <th></th>
                </tr>
                </thead>

                <tbody>
                <tr *ngFor="let method of sortedMethods()" (mouseenter)="selectMethod(method)">
                    <td>{{method.signature}}</td>
                    <td>{{method.lastInvokedAtMillis | ckAge:dateFormat }}</td>
                    <td><i [ngClass]="rowIconClasses(method)" aria-hidden="true"></i></td>
                </tr>
                </tbody>
            </table>
        </div>

        <div *ngIf="selectedMethod" id="method-details" class="col-4">
            <table class="table table-bordered table-sm">
                <thead>
                <tr>
                    <th colspan="2">Collection Details
                        <button type="button" class="close" aria-label="Close" (click)="selectMethod(null)">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <th>Id:</th>
                    <td>{{ selectedMethod.id }}</td>
                </tr>
                <tr>
                    <th>Collected Days:</th>
                    <td>{{ selectedMethod.collectedDays }}</td>
                </tr>
                <tr>
                    <th>Collected Since:</th>
                    <td>{{ selectedMethod.collectedSinceMillis | ckAge }}</td>
                </tr>
                <tr>
                    <th>Collected To:</th>
                    <td>{{ selectedMethod.collectedToMillis | ckAge }}</td>
                </tr>
                <tr>
                    <th>Last Invoked At:</th>
                    <td>{{ selectedMethod.lastInvokedAtMillis | ckAge }}</td>
                </tr>
                <tr>
                    <th>Last Invoked Age:</th>
                    <td>{{ selectedMethod.lastInvokedAtMillis | ckAge:'age' }}</td>
                </tr>
                </tbody>
            </table>

            <!--
                tags: string[];
                collectedInEnvironments: Environment[];
                occursInApplications: Application[];
            -->
        </div>
    </div>
</div>
